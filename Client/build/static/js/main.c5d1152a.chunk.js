(this["webpackJsonppolyclinic-client"]=this["webpackJsonppolyclinic-client"]||[]).push([[0],{54:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);n(0);var o=n(6),r=n.n(o),a=n(5),s=n(4),i=n(7),c=n(8),u="polyclinictoken",l=new(function(){function e(){Object(i.a)(this,e),this._token=void 0;var t=localStorage.getItem(u);if(t){var n=JSON.parse(t);Math.floor(+new Date/1e3)>n.expires_in?this.removeToken():this._token=n}else this._token=null}return Object(c.a)(e,[{key:"getToken",value:function(){return this._token?this._token.access_token:null}},{key:"setToken",value:function(e,t){e.expires_in=Math.floor(+new Date/1e3)+e.expires_in,t&&localStorage.setItem(u,JSON.stringify(e)),this._token=e}},{key:"removeToken",value:function(){localStorage.removeItem(u),this._token=null}}]),e}()),d=n(13),h=n.n(d),p=n(23),f=n(24),k=n.n(f),g=(new(function(){function e(){Object(i.a)(this,e),this.instance=void 0;var t=k.a.create({baseURL:"https://localhost:44372/"});t.interceptors.request.use(this.handleToken),t.interceptors.response.use(this.handleSuccess,this.handleError),this.instance=t}return Object(c.a)(e,[{key:"handleToken",value:function(e){var t=l.getToken();return t&&(e.headers.Authorization="Bearer ".concat(t)),e}},{key:"handleSuccess",value:function(e){return e}},{key:"handleError",value:function(e){return e.response&&e.response.status&&(e.response.status,console.warn("Error: ",e.response.data)),Promise.reject(e.response)}}]),e}())).instance,b=g.get,m=(g.post,g.put,g.delete,function(e){var t=e.payload,n=t.email,o=t.password;return b("/api/User/token",{params:{email:n,password:o}})}),v=Object(s.b)("auth/fetchLogin",function(){var e=Object(p.a)(h.a.mark((function e(t){var n,o,r,a,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,o=t.password,r=t.rememberMe,e.next=3,m({payload:{email:n,password:o}});case 3:return a=e.sent,s=a.data,e.abrupt("return",{token:s,rememberMe:r});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),j={loadingFlags:{},isAuthorized:Boolean(l.getToken())},y=Object(s.c)({name:"auth",initialState:j,reducers:{logout:function(e){e.isAuthorized=!1,l.removeToken()}},extraReducers:function(e){e.addCase(v.pending,(function(e){e.loadingFlags[v.typePrefix]=!0})),e.addCase(v.fulfilled,(function(e,t){var n=t.payload,o=n.token,r=n.rememberMe;e.isAuthorized=!0,e.loadingFlags[v.typePrefix]=!1,l.setToken(o,r)})),e.addCase(v.rejected,(function(e,t){var n=t.payload;console.log(n)}))}}),O=y.actions.logout,w=y.reducer,x=Object(s.a)({reducer:{auth:w}}),_=Object(a.b)(),T=(n(54),n(3)),A=function(){var e=Object(a.c)(),t=_((function(e){return{isAuthorized:e.auth.isAuthorized,loadingFlags:e.auth.loadingFlags}})),n=t.isAuthorized,o=t.loadingFlags;return Object(T.jsxs)("div",{className:"App",children:[o[v.typePrefix]&&Object(T.jsx)("span",{children:"Loading..."}),n?Object(T.jsx)("button",{onClick:function(){e(O())},children:"Log out"}):Object(T.jsx)("button",{onClick:function(){e(v({email:"artem.sdobnikov@nure.ua",password:"Qwerty12345!",rememberMe:!0}))},children:"Log in"})]})};r.a.render(Object(T.jsx)(a.a,{store:x,children:Object(T.jsx)(A,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.c5d1152a.chunk.js.map